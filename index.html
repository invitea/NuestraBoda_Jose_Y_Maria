<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>Nuestra Boda — Maria y Jose</title>
  
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=Montserrat:wght@300;400;500;600&family=Parisienne&display=swap" rel="stylesheet" />

  <style>
    /* Nueva paleta de colores basada en la invitación de boda */
    :root {
      --bg: #f8f6f2;           /* Fondo principal - beige muy claro */
      --card-bg: #ffffff;      /* Fondo de tarjetas - blanco puro */
      --muted: #e8e3db;        /* Elementos sutiles - beige claro */
      --accent: #8b7355;       /* Color principal - marrón dorado */
      --accent-2: #6d5c45;     /* Color secundario - marrón más oscuro */
      --map-btn: #9a8b76;      /* Botones - marrón medio */
      --text: #3a3a3a;         /* Texto principal - gris oscuro */
      --muted-text: #7a7a7a;   /* Texto secundario - gris medio */
      --shadow: rgba(0,0,0,0.08); /* Sombra más suave */
      --focus-ring: rgba(139,115,85,0.18); /* Anillo de enfoque */
      --error: #a52a2a;        /* Error - marrón rojizo */
      --warning: #b8860b;      /* Advertencia - dorado oscuro */
      --success: #556b2f;      /* Éxito - verde oliva */
      --gold: #d4af37;         /* Dorado para acentos */
      --max-width: 1000px;
      --container-padding: 18px;
    }

    * {
      box-sizing: border-box;
      -webkit-tap-highlight-color: transparent;
    }

    html, body {
      height: 100%;
      margin: 0;
    }

    body {
      font-family: 'Montserrat', sans-serif;
      background: var(--bg);
      color: var(--text);
      -webkit-font-smoothing: antialiased;
      position: relative;
      overflow-x: hidden;
      background-image: 
        radial-gradient(circle at 10% 20%, rgba(232, 227, 219, 0.3) 0%, transparent 20%),
        radial-gradient(circle at 90% 80%, rgba(232, 227, 219, 0.3) 0%, transparent 20%);
    }

    /* Elementos decorativos actualizados */
    .decoration {
      position: absolute;
      z-index: 0;
      opacity: 0.15;
    }

    .decoration.circle {
      width: 120px;
      height: 120px;
      border-radius: 50%;
      border: 2px solid var(--accent);
      top: 10%;
      right: 10%;
    }

    .decoration.flower {
      width: 80px;
      height: 80px;
      background: 
        radial-gradient(circle, var(--accent) 20%, transparent 20%),
        radial-gradient(circle, transparent 20%, var(--accent) 20%, transparent 30%),
        radial-gradient(circle, var(--accent) 10%, transparent 10%);
      background-size: 20px 20px, 40px 40px, 20px 20px;
      background-position: 0 0, 20px 20px, 0 40px;
      bottom: 15%;
      left: 8%;
      transform: rotate(25deg);
    }

    /* Contenedor principal */
    .invitation-container {
      max-width: var(--max-width);
      margin: 0 auto;
      min-height: 100vh;
      background: var(--card-bg);
      text-align: center;
      box-shadow: 0 4px 12px var(--shadow);
      position: relative;
      z-index: 1;
      animation: fadeInScale 0.8s ease-out;
      border: 1px solid var(--muted);
    }

    /* Cabecera actualizada */
    .header-section {
      padding: 20px 16px 6px;
      background: linear-gradient(to bottom, var(--bg), var(--card-bg) 30%);
      position: relative;
      overflow: hidden;
    }

    .header-section::before {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(to right, var(--accent), var(--gold), var(--accent));
    }

    .invitation-heading {
      font-size: 14px;
      letter-spacing: 1.5px;
      text-transform: uppercase;
      color: var(--accent);
      margin-bottom: 6px;
      position: relative;
      display: inline-block;
    }

    .invitation-heading::after {
      content: "";
      position: absolute;
      bottom: -5px;
      left: 25%;
      right: 25%;
      height: 1px;
      background: var(--muted);
    }

    .event-title {
      position: relative;
      margin: 10px 0;
    }

    .event-title .first-word {
      font-family: 'Parisienne', cursive;
      font-size: 50px;
      color: var(--accent);
      display: block;
      line-height: 1;
      text-shadow: 1px 1px 2px rgba(0,0,0,0.05);
      animation: fadeInUp 0.8s ease-out;
    }

    .event-title .second-word {
      font-family: 'Parisienne', cursive;
      font-size: 36px;
      color: var(--accent);
      display: block;
      margin-top: -8px;
      animation: fadeInUp 0.8s ease-out 0.2s both;
    }

    .wedding-image {
      width: 85%;
      max-width: 320px;
      height: auto;
      margin: 10px auto 12px;
      border-radius: 8px;
      object-fit: cover;
      box-shadow: 0 4px 12px var(--shadow);
      display: block;
      loading: lazy;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      border: 3px solid var(--card-bg);
      outline: 1px solid var(--muted);
    }

    .wedding-image:hover {
      transform: scale(1.02);
      box-shadow: 0 6px 18px rgba(0,0,0,0.12);
    }

    .couple-names {
      font-family: 'Parisienne', cursive;
      font-size: 48px;
      color: var(--accent);
      margin: 6px 0 10px;
      line-height: 1.05;
      animation: fadeInUp 0.8s ease-out 0.4s both;
      position: relative;
      display: inline-block;
    }

    .couple-names::after {
      content: "";
      position: absolute;
      bottom: -5px;
      left: 10%;
      right: 10%;
      height: 2px;
      background: linear-gradient(to right, transparent, var(--accent), transparent);
    }

    .wedding-message {
      font-size: 16px;
      color: var(--muted-text);
      line-height: 1.6;
      max-width: 80%;
      margin: 0 auto 20px;
      font-style: italic;
    }

    /* Contenido principal */
    .content-section {
      padding: 0 16px 36px;
      animation: fadeIn 1s ease-out 0.6s both;
    }

    .event-date {
      font-size: 15px;
      text-transform: uppercase;
      font-weight: 500;
      color: var(--accent-2);
      padding: 12px 0;
      border-top: 1px solid var(--muted);
      border-bottom: 1px solid var(--muted);
      max-width: 90%;
      margin: 18px auto;
      letter-spacing: 0.5px;
      position: relative;
      background: linear-gradient(to right, transparent, rgba(139,115,85,0.05), transparent);
    }

    /* Tarjetas de evento actualizadas */
    .event-card {
      max-width: 92%;
      margin: 14px auto;
      padding: 14px 12px;
      background: rgba(232,227,219,0.15);
      border-top: 1px solid var(--muted);
      border-bottom: 1px solid var(--muted);
      border-radius: 8px;
      text-align: center;
      display: block;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      position: relative;
      overflow: hidden;
    }

    .event-card::before {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      width: 4px;
      height: 100%;
      background: var(--accent);
      opacity: 0.7;
    }

    .event-card:hover {
      transform: translateY(-3px);
      box-shadow: 0 5px 15px rgba(0,0,0,0.08);
    }

    .event-type {
      font-weight: 600;
      font-size: 14px;
      color: var(--accent-2);
      margin-bottom: 6px;
      position: relative;
      display: inline-block;
    }

    .event-type::after {
      content: "";
      position: absolute;
      bottom: -3px;
      left: 0;
      right: 0;
      height: 1px;
      background: var(--muted);
    }

    .event-time {
      font-size: 14px;
      color: var(--accent-2);
      margin-bottom: 8px;
      font-weight: 500;
    }

    .event-location {
      font-style: italic;
      font-size: 13px;
      color: var(--muted-text);
      line-height: 1.4;
      white-space: pre-line;
      text-align: center;
    }

    /* Botones actualizados */
    .map-button, .confirm-button, .gift-button {
      display: inline-block;
      margin: 10px auto;
      padding: 12px 25px;
      border-radius: 25px;
      font-size: 14px;
      font-weight: 500;
      cursor: pointer;
      border: none;
      transition: all .18s ease;
      min-width: 160px;
      text-decoration: none;
      color: #fff;
      position: relative;
      overflow: hidden;
      z-index: 1;
    }

    .map-button::before, .confirm-button::before, .gift-button::before {
      content: "";
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
      transition: left 0.5s;
      z-index: -1;
    }

    .map-button:hover::before, .confirm-button:hover::before, .gift-button:hover::before {
      left: 100%;
    }

    .map-button, .gift-button {
      background: var(--map-btn);
      box-shadow: 0 3px 8px rgba(154,139,118,0.3);
    }

    .map-button:hover, .gift-button:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 12px rgba(154,139,118,0.4);
    }

    .confirm-button {
      background: var(--accent);
      margin-bottom: 30px;
      box-shadow: 0 3px 8px rgba(139,115,85,0.3);
    }

    .confirm-button:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 12px rgba(139,115,85,0.4);
    }

    /* Cuenta regresiva actualizada */
    .countdown-container {
      display: flex;
      justify-content: center;
      gap: 12px;
      margin: 15px 0;
      flex-wrap: wrap;
    }

    .countdown-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      background: rgba(139, 115, 85, 0.1);
      border-radius: 8px;
      padding: 10px 8px;
      min-width: 60px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.05);
    }

    .countdown-value {
      font-size: 24px;
      font-weight: 700;
      color: var(--accent);
      line-height: 1;
    }

    .countdown-label {
      font-size: 11px;
      color: var(--muted-text);
      text-transform: uppercase;
      margin-top: 4px;
      letter-spacing: 0.5px;
    }

    .countdown-message {
      font-size: 13px;
      color: var(--accent);
      font-style: italic;
      margin-top: 8px;
      font-weight: 500;
    }

    /* Galería Cover Flow actualizada */
    .coverflow-container {
      position: relative;
      width: 100%;
      height: 320px;
      margin: 25px 0 15px;
      perspective: 1200px;
      overflow: hidden;
    }

    .coverflow-track {
      position: absolute;
      width: 100%;
      height: 100%;
      transform-style: preserve-3d;
      transition: transform 0.7s cubic-bezier(0.23, 1, 0.32, 1);
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .coverflow-item {
      position: absolute;
      width: 200px;
      height: 260px;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 10px 25px rgba(0,0,0,0.15), 0 5px 15px rgba(0,0,0,0.1),
                 inset 0 0 1px rgba(255,255,255,0.5);
      transition: all 0.5s cubic-bezier(0.23, 1, 0.32, 1);
      cursor: pointer;
      background: white;
      border: 1px solid rgba(255,255,255,0.3);
    }

    .coverflow-image {
      width: 100%;
      height: 100%;
      object-fit: cover;
      transition: transform 0.4s ease;
    }

    .coverflow-item:hover .coverflow-image {
      transform: scale(1.08);
    }

    .coverflow-nav {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin: 20px 0 10px;
    }

    .coverflow-nav-button {
      width: 50px;
      height: 50px;
      border-radius: 50%;
      border: 2px solid var(--accent);
      background: white;
      color: var(--accent);
      font-size: 20px;
      font-weight: bold;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s ease;
      box-shadow: 0 4px 12px rgba(139,115,85,0.2);
    }

    .coverflow-nav-button:hover {
      background: var(--accent);
      color: white;
      transform: translateY(-3px);
      box-shadow: 0 6px 20px rgba(139,115,85,0.4);
    }

    .coverflow-nav-button:disabled {
      opacity: 0.3;
      cursor: not-allowed;
      transform: none;
      background: white;
      color: var(--accent);
    }

    .coverflow-dots {
      display: flex;
      justify-content: center;
      gap: 10px;
      margin: 15px 0 5px;
    }

    .coverflow-dot {
      width: 12px;
      height: 12px;
      border-radius: 50%;
      background: var(--muted);
      cursor: pointer;
      transition: all 0.3s ease;
      border: 2px solid transparent;
    }

    .coverflow-dot.active {
      background: var(--accent);
      transform: scale(1.3);
      border-color: rgba(139,115,85,0.3);
    }

    .coverflow-dot:hover:not(.active) {
      background: var(--accent-2);
      transform: scale(1.1);
    }

    .coverflow-counter {
      font-size: 14px;
      color: var(--muted-text);
      margin-top: 8px;
      font-weight: 500;
    }

    /* Código de Vestimenta actualizado */
    .dresscode-container {
      max-width: 92%;
      margin: 14px auto;
      padding: 14px 12px;
      background: rgba(232,227,219,0.15);
      border-top: 1px solid var(--muted);
      border-bottom: 1px solid var(--muted);
      border-radius: 8px;
      text-align: center;
      display: block;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      position: relative;
      overflow: hidden;
    }

    .dresscode-container::before {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      width: 4px;
      height: 100%;
      background: var(--accent);
      opacity: 0.7;
    }

    .dresscode-container:hover {
      transform: translateY(-3px);
      box-shadow: 0 5px 15px rgba(0,0,0,0.08);
    }

    .dresscode-title {
      font-weight: 600;
      font-size: 14px;
      color: var(--accent-2);
      margin-bottom: 6px;
      position: relative;
      display: inline-block;
    }

    .dresscode-title::after {
      content: "";
      position: absolute;
      bottom: -3px;
      left: 0;
      right: 0;
      height: 1px;
      background: var(--muted);
    }

    .dresscode-icons {
      display: flex;
      justify-content: center;
      gap: 40px;
      margin: 20px 0;
      flex-wrap: wrap;
    }

    .dresscode-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      transition: transform 0.3s ease;
    }

    .dresscode-item:hover {
      transform: translateY(-5px);
    }

    .dresscode-icon {
      width: 80px;
      height: 80px;
      background: white;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      border: 2px solid var(--accent);
      margin-bottom: 10px;
      box-shadow: 0 4px 12px rgba(139,115,85,0.2);
    }

    .dresscode-icon svg {
      width: 40px;
      height: 40px;
      fill: var(--accent);
    }

    .dresscode-label {
      font-size: 14px;
      color: var(--text);
      font-weight: 500;
    }

    .dresscode-note {
      font-size: 13px;
      color: var(--muted-text);
      font-style: italic;
      margin-top: 10px;
      max-width: 80%;
      margin-left: auto;
      margin-right: auto;
    }

    /* Itinerario actualizado */
    .itinerario-container {
      max-width: 92%;
      margin: 14px auto;
      padding: 14px 12px;
      background: rgba(232,227,219,0.15);
      border-top: 1px solid var(--muted);
      border-bottom: 1px solid var(--muted);
      border-radius: 8px;
      text-align: center;
      display: block;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      position: relative;
      overflow: hidden;
    }

    .itinerario-container::before {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      width: 4px;
      height: 100%;
      background: var(--accent);
      opacity: 0.7;
    }

    .itinerario-container:hover {
      transform: translateY(-3px);
      box-shadow: 0 5px 15px rgba(0,0,0,0.08);
    }

    .itinerario-title {
      font-weight: 600;
      font-size: 14px;
      color: var(--accent-2);
      margin-bottom: 6px;
      position: relative;
      display: inline-block;
    }

    .itinerario-title::after {
      content: "";
      position: absolute;
      bottom: -3px;
      left: 0;
      right: 0;
      height: 1px;
      background: var(--muted);
    }

    .timeline {
      position: relative;
      max-width: 800px;
      margin: 20px auto;
    }

    .timeline::before {
      content: "";
      position: absolute;
      top: 0;
      bottom: 0;
      left: 50%;
      width: 2px;
      background: var(--accent);
      transform: translateX(-50%);
    }

    .timeline-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 30px;
      position: relative;
    }

    .timeline-item:nth-child(odd) {
      flex-direction: row-reverse;
    }

    .timeline-content {
      width: 45%;
      padding: 15px;
      background: white;
      border-radius: 8px;
      box-shadow: 0 3px 10px rgba(0,0,0,0.08);
      position: relative;
    }

    .timeline-item:nth-child(odd) .timeline-content {
      text-align: right;
    }

    .timeline-time {
      font-weight: 600;
      color: var(--accent);
      margin-bottom: 5px;
      font-size: 16px;
    }

    .timeline-event {
      font-size: 14px;
      color: var(--text);
    }

    .timeline-icon {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 40px;
      height: 40px;
      background: var(--card-bg);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      border: 2px solid var(--accent);
      z-index: 2;
    }

    .timeline-icon svg {
      width: 20px;
      height: 20px;
      fill: var(--accent);
    }

    /* Recomendación de Hospedaje actualizada */
    .hotel-container {
      max-width: 92%;
      margin: 14px auto;
      padding: 14px 12px;
      background: rgba(232,227,219,0.15);
      border-top: 1px solid var(--muted);
      border-bottom: 1px solid var(--muted);
      border-radius: 8px;
      text-align: center;
      display: block;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      position: relative;
      overflow: hidden;
    }

    .hotel-container::before {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      width: 4px;
      height: 100%;
      background: var(--accent);
      opacity: 0.7;
    }

    .hotel-container:hover {
      transform: translateY(-3px);
      box-shadow: 0 5px 15px rgba(0,0,0,0.08);
    }

    .hotel-title {
      font-weight: 600;
      font-size: 14px;
      color: var(--accent-2);
      margin-bottom: 6px;
      position: relative;
      display: inline-block;
    }

    .hotel-title::after {
      content: "";
      position: absolute;
      bottom: -3px;
      left: 0;
      right: 0;
      height: 1px;
      background: var(--muted);
    }

    .hotels-grid {
      display: flex;
      justify-content: center;
      gap: 30px;
      margin: 20px 0;
      flex-wrap: wrap;
    }

    .hotel-card {
      flex: 1;
      min-width: 280px;
      max-width: 350px;
      background: white;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 4px 15px rgba(0,0,0,0.1);
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }

    .hotel-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 25px rgba(0,0,0,0.15);
    }

    .hotel-image {
      width: 100%;
      height: 180px;
      object-fit: cover;
    }

    .hotel-info {
      padding: 15px;
    }

    .hotel-name {
      font-size: 16px;
      font-weight: 600;
      color: var(--accent);
      margin-bottom: 8px;
    }

    .hotel-address {
      font-size: 13px;
      color: var(--muted-text);
      line-height: 1.4;
      margin-bottom: 12px;
      font-style: italic;
    }

    .hotel-button {
      display: inline-block;
      padding: 8px 20px;
      border-radius: 20px;
      font-size: 13px;
      font-weight: 500;
      cursor: pointer;
      border: none;
      transition: all .18s ease;
      text-decoration: none;
      color: #fff;
      background: var(--map-btn);
      box-shadow: 0 3px 8px rgba(154,139,118,0.3);
    }

    .hotel-button:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 12px rgba(154,139,118,0.4);
    }

    /* Modal de galería actualizado */
    .gallery-modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.92);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 2000;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s ease;
    }

    .gallery-modal.active {
      opacity: 1;
      pointer-events: all;
    }

    .gallery-modal-content {
      position: relative;
      max-width: 90%;
      max-height: 90%;
      text-align: center;
    }

    .gallery-modal-image {
      max-width: 100%;
      max-height: 80vh;
      border-radius: 12px;
      box-shadow: 0 20px 50px rgba(0,0,0,0.5);
    }

    .gallery-modal-caption {
      color: white;
      margin-top: 20px;
      font-size: 18px;
      font-style: italic;
      font-weight: 500;
    }

    .gallery-modal-close {
      position: absolute;
      top: -60px;
      right: 0;
      background: var(--accent);
      color: white;
      border: none;
      width: 45px;
      height: 45px;
      border-radius: 50%;
      font-size: 22px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s ease;
      box-shadow: 0 4px 15px rgba(0,0,0,0.3);
    }

    .gallery-modal-close:hover {
      background: var(--accent-2);
      transform: scale(1.1);
    }

    .gallery-modal-nav {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      background: rgba(139,115,85,0.9);
      color: white;
      border: none;
      width: 55px;
      height: 55px;
      border-radius: 50%;
      font-size: 22px;
      font-weight: bold;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s ease;
      box-shadow: 0 4px 15px rgba(0,0,0,0.3);
    }

    .gallery-modal-nav:hover {
      background: var(--accent);
      transform: translateY(-50%) scale(1.1);
    }

    .gallery-modal-prev {
      left: 25px;
    }

    .gallery-modal-next {
      right: 25px;
    }

    /* Modal de confirmación actualizado */
    .modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      background: rgba(0,0,0,0.45);
      z-index: 1000;
      opacity: 0;
      pointer-events: none;
      transition: opacity .25s ease;
    }

    .modal.active {
      opacity: 1;
      pointer-events: all;
    }

    .modal-content {
      position: relative;
      width: 92%;
      max-width: 400px;
      background: var(--card-bg);
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 8px 24px var(--shadow);
      border-top: 3px solid var(--accent);
      transform: translateY(16px);
      transition: transform .25s ease;
      max-height: 90vh;
      overflow-y: auto;
    }

    .modal.active .modal-content {
      transform: translateY(0);
    }

    .close-modal {
      position: absolute;
      top: 10px;
      right: 10px;
      width: 34px;
      height: 34px;
      border-radius: 6px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: transparent;
      border: none;
      cursor: pointer;
      color: var(--accent);
      font-size: 18px;
      padding: 0;
      z-index: 3;
      transition: background 0.2s;
    }

    .close-modal:hover {
      background: rgba(139,115,85,0.1);
    }

    .modal-title {
      font-family: 'Parisienne', cursive;
      color: var(--accent);
      font-size: 22px;
      margin: 0 0 12px;
      text-align: center;
    }

    .form-group {
      margin-bottom: 12px;
      text-align: left;
      position: relative;
    }

    .form-label {
      display: block;
      margin-bottom: 6px;
      font-size: 13px;
      color: var(--accent-2);
      font-weight: 500;
    }

    .modal-content input[type="text"],
    .modal-content input[type="number"],
    .modal-content input[type="email"],
    .modal-content input[type="tel"] {
      width: 100%;
      padding: 10px 12px;
      border-radius: 8px;
      border: 1px solid var(--muted);
      background: #f9f5f1;
      font-size: 14px;
      transition: all 0.2s;
    }

    .modal-content input:focus {
      outline: none;
      box-shadow: 0 0 0 6px var(--focus-ring);
      border-color: var(--accent);
    }

    .modal-content input.error {
      border-color: var(--error);
      box-shadow: 0 0 0 6px rgba(165, 42, 42, 0.1);
    }

    .modal-content input.warning {
      border-color: var(--warning);
      box-shadow: 0 0 0 6px rgba(184, 134, 11, 0.1);
    }

    .error-message, .warning-message {
      color: var(--error);
      font-size: 12px;
      margin-top: 4px;
      display: none;
    }

    .warning-message {
      color: var(--warning);
    }

    .submit-btn {
      width: 100%;
      padding: 12px;
      border-radius: 20px;
      border: none;
      background: var(--accent);
      color: #fff;
      font-weight: 600;
      cursor: pointer;
      margin-top: 6px;
      transition: all 0.2s;
    }

    .submit-btn:hover:not([disabled]) {
      transform: translateY(-2px);
      box-shadow: 0 4px 10px rgba(139,115,85,0.4);
    }

    .submit-btn[disabled] {
      opacity: 0.6;
      cursor: not-allowed;
    }

    .loading-spinner {
      display: none;
      width: 24px;
      height: 24px;
      margin: 10px auto;
      border: 3px solid rgba(139,115,85,0.28);
      border-top-color: var(--accent);
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }

    .success {
      font-family: 'Parisienne', cursive;
      font-size: 20px;
      color: var(--success);
      text-align: center;
      display: none;
      margin-top: 12px;
      animation: pulse 1.5s infinite;
    }

    footer {
      text-align: center;
      padding: 12px 6px;
      font-size: 12px;
      color: var(--muted-text);
      background: transparent;
      border-top: 1px solid var(--muted);
    }

    :focus {
      outline: 3px solid var(--focus-ring);
      outline-offset: 2px;
    }

    /* Animaciones */
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes fadeInScale {
      from {
        opacity: 0;
        transform: scale(0.98);
      }
      to {
        opacity: 1;
        transform: scale(1);
      }
    }

    @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.05); }
      100% { transform: scale(1); }
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    /* Responsive */
    @media (max-width:768px) {
      .coverflow-container { height: 280px; }
      .coverflow-item { width: 170px; height: 220px; }
      .gallery-modal-nav, .coverflow-nav-button { width: 45px; height: 45px; font-size: 18px; }
      .gallery-modal-prev { left: 15px; }
      .gallery-modal-next { right: 15px; }
      .timeline::before { left: 30px; }
      .timeline-item, .timeline-item:nth-child(odd) {
        flex-direction: row;
        justify-content: flex-start;
      }
      .timeline-content {
        width: calc(100% - 80px);
        margin-left: 80px;
        text-align: left !important;
      }
      .timeline-icon { left: 30px; transform: translate(-50%, -50%); }
      .dresscode-icons { gap: 20px; }
      .hotels-grid { gap: 20px; }
    }

    @media (max-width:480px) {
      .coverflow-container { height: 240px; }
      .coverflow-item { width: 140px; height: 180px; }
      .coverflow-nav-button { width: 40px; height: 40px; font-size: 16px; }
      .gallery-modal-caption { font-size: 16px; margin-top: 15px; }
      .couple-names { font-size: 40px; }
      .event-title .first-word { font-size: 42px; }
      .event-title .second-word { font-size: 30px; }
      .decoration { display: none; }
      .timeline-content { width: calc(100% - 60px); margin-left: 60px; }
      .timeline-icon { width: 30px; height: 30px; left: 30px; }
      .timeline-icon svg { width: 16px; height: 16px; }
      .dresscode-icon { width: 60px; height: 60px; }
      .dresscode-icon svg { width: 30px; height: 30px; }
      .hotel-card { min-width: 100%; }
    }
  </style>
</head>

<body>
  <!-- Elementos decorativos -->
  <div class="decoration circle"></div>
  <div class="decoration flower"></div>

  <!-- Contenido principal -->
  <div class="invitation-container">
    <div class="header-section" role="banner">
      <div class="invitation-heading">Tenemos el gusto de invitarte en este día</div>
      <div class="event-title" aria-hidden="true">
        <span class="first-word">Nuestra Boda</span>
      </div>

      <img class="wedding-image" src="https://i.ibb.co/fzTcNfzT/Maria-YJose.png" alt="Maria y Jose" loading="lazy" />
      <div class="wedding-message">Este día muy especial estaremos junto a nuestros seres queridos.</div>
    </div>

    <div class="content-section" role="main">
      <div class="event-date" id="dynamicDate" aria-label="Fecha del evento"></div>

      <!-- Cuenta Regresiva -->
      <div class="event-card" aria-labelledby="cuenta-regresiva">
        <div id="cuenta-regresiva" class="event-type">Cuenta Regresiva</div>
        <div class="countdown-container">
          <div class="countdown-item">
            <div id="days" class="countdown-value">00</div>
            <div class="countdown-label">Días</div>
          </div>
          <div class="countdown-item">
            <div id="hours" class="countdown-value">00</div>
            <div class="countdown-label">Horas</div>
          </div>
          <div class="countdown-item">
            <div id="minutes" class="countdown-value">00</div>
            <div class="countdown-label">Minutos</div>
          </div>
          <div class="countdown-item">
            <div id="seconds" class="countdown-value">00</div>
            <div class="countdown-label">Segundos</div>
          </div>
        </div>
        <div id="countdown-message" class="countdown-message"></div>
      </div>

      <!-- Galería -->
      <div class="event-card" aria-labelledby="galeria">
        <div id="galeria" class="event-type">Nuestra Historia</div>
        <div class="event-location">Momentos especiales de nuestro camino juntos</div>
        
        <div class="coverflow-container">
          <div class="coverflow-track" id="coverflowTrack"></div>
        </div>
        
        <div class="coverflow-nav">
          <button class="coverflow-nav-button" id="coverflowPrev" aria-label="Imagen anterior">‹</button>
          <button class="coverflow-nav-button" id="coverflowNext" aria-label="Imagen siguiente">›</button>
        </div>
        
        <div class="coverflow-dots" id="coverflowDots"></div>
        <div class="coverflow-counter" id="coverflowCounter">1 / 7</div>
      </div>

      <!-- Ceremonia -->
      <div class="event-card" aria-labelledby="ceremonia">
        <div id="ceremonia" class="event-type">Ceremonia</div>
        <div class="event-time">10:00 hrs</div>
        <div class="event-location">
          Parroquia Santa María<br/>
          Calle Cualquiera 123, Cualquier Lugar<br/>
          Ciudad de México, CDMX
        </div>
        <a class="map-button" href="https://www.google.com/maps/search/?api=1&query=Calle+Cualquiera+123%2C+Cualquier+Lugar%2C+Ciudad+de+M%C3%A9xico%2C+CDMX" target="_blank" rel="noopener noreferrer">Cómo llegar</a>
      </div>

      <!-- Recepción -->
      <div class="event-card" aria-labelledby="recepcion">
        <div id="recepcion" class="event-type">Recepción</div>
        <div class="event-time">13:00 hrs</div>
        <div class="event-location">
          Salón de Eventos "Jardines del Amor"<br/>
          Avenida Siempre Viva 742, Col. Centro<br/>
          Ciudad de México, CDMX
        </div>
        <a class="map-button" href="https://www.google.com/maps/search/?api=1&query=Avenida+Siempre+Viva+742%2C+Col.+Centro%2C+Ciudad+de+M%C3%A9xico%2C+CDMX" target="_blank" rel="noopener noreferrer">Cómo llegar</a>
      </div>

      <!-- Mesa de Regalos -->
      <div class="event-card" aria-labelledby="regalos">
        <div id="regalos" class="event-type">Mesa de Regalos</div>
        <div class="event-location">
          Si deseas tener un detalle con nosotros, puedes visitar nuestra mesa de regalos
        </div>
        <a class="gift-button" href="https://mesaderegalos.liverpool.com.mx/" target="_blank" rel="noopener noreferrer">Ver Regalos</a>
      </div>

      <!-- Código de Vestimenta -->
      <div class="dresscode-container" aria-labelledby="dresscode">
        <div id="dresscode" class="dresscode-title">Código de Vestimenta</div>
        <div class="dresscode-icons">
          <div class="dresscode-item">
            <div class="dresscode-icon">
              <svg viewBox="0 0 24 24">
                <!-- Icono de saco formal para caballeros -->
                <path d="M20 6h-3V4c0-1.1-.9-2-2-2H9c-1.1 0-2 .9-2 2v2H4c-1.1 0-2 .9-2 2v11c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2zM9 4h6v2H9V4zm11 15H4v-2h4v1h2v-1h4v1h2v-1h4v2zm0-5H4V8h3v1h2V8h6v1h2V8h3v6z"/>
                <path d="M7 15h2v2H7zM15 15h2v2h-2z"/>
              </svg>
            </div>
            <div class="dresscode-label">Traje Formal</div>
          </div>
          <div class="dresscode-item">
            <div class="dresscode-icon">
              <svg viewBox="0 0 24 24">
                <!-- Icono de vestido elegante para damas -->
                <path d="M21 6H3c-1.1 0-2 .9-2 2v8c0 1.1.9 2 2 2h18c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2zm-9 12c-2.76 0-5-2.24-5-5h2c0 1.66 1.34 3 3 3s3-1.34 3-3h2c0 2.76-2.24 5-5 5z"/>
                <path d="M9 8h6v2H9z"/>
              </svg>
            </div>
            <div class="dresscode-label">Vestido Elegante</div>
          </div>
        </div>
        <div class="dresscode-note">Vestimenta formal - Etiqueta de gala para esta ocasión especial</div>
      </div>

      <!-- Itinerario -->
      <div class="itinerario-container" aria-labelledby="itinerario">
        <div id="itinerario" class="itinerario-title">Itinerario del Día</div>
        <div class="timeline">
          <div class="timeline-item">
            <div class="timeline-content">
              <div class="timeline-time">09:30 AM</div>
              <div class="timeline-event">Llegada de invitados a la iglesia</div>
            </div>
            <div class="timeline-icon">
              <svg viewBox="0 0 24 24">
                <path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/>
              </svg>
            </div>
          </div>
          
          <div class="timeline-item">
            <div class="timeline-content">
              <div class="timeline-time">10:00 AM</div>
              <div class="timeline-event">Ceremonia religiosa</div>
            </div>
            <div class="timeline-icon">
              <svg viewBox="0 0 24 24">
                <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
              </svg>
            </div>
          </div>
          
          <div class="timeline-item">
            <div class="timeline-content">
              <div class="timeline-time">11:30 AM</div>
              <div class="timeline-event">Sesión de fotos con los novios</div>
            </div>
            <div class="timeline-icon">
              <svg viewBox="0 0 24 24">
                <path d="M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm8.94 3c-.46-4.17-3.77-7.48-7.94-7.94V1h-2v2.06C6.83 3.52 3.52 6.83 3.06 11H1v2h2.06c.46 4.17 3.77 7.48 7.94 7.94V23h2v-2.06c4.17-.46 7.48-3.77 7.94-7.94H23v-2h-2.06zM12 19c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z"/>
              </svg>
            </div>
          </div>
          
          <div class="timeline-item">
            <div class="timeline-content">
              <div class="timeline-time">01:00 PM</div>
              <div class="timeline-event">Coctel de bienvenida en recepción</div>
            </div>
            <div class="timeline-icon">
              <svg viewBox="0 0 24 24">
                <path d="M20 6h-4V4c0-1.11-.89-2-2-2h-4c-1.11 0-2 .89-2 2v2H4c-1.11 0-1.99.89-1.99 2L2 19c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V8c0-1.11-.89-2-2-2zm-6 0h-4V4h4v2z"/>
              </svg>
            </div>
          </div>
          
          <div class="timeline-item">
            <div class="timeline-content">
              <div class="timeline-time">02:00 PM</div>
              <div class="timeline-event">Banquete</div>
            </div>
            <div class="timeline-icon">
              <svg viewBox="0 0 24 24">
                <path d="M12 3c-4.97 0-9 4.03-9 9s4.03 9 9 9 9-4.03 9-9-4.03-9-9-9zm0 16c-3.86 0-7-3.14-7-7s3.14-7 7-7 7 3.14 7 7-3.14 7-7 7zm1-11H11v6h2V8zm0 8H11v2h2v-2z"/>
              </svg>
            </div>
          </div>
          
          <div class="timeline-item">
            <div class="timeline-content">
              <div class="timeline-time">04:00 PM</div>
              <div class="timeline-event">Brindis y corte de pastel</div>
            </div>
            <div class="timeline-icon">
              <svg viewBox="0 0 24 24">
                <path d="M13 2v8h8c0-4.42-3.58-8-8-8zm6.32 13.89C20.37 14.54 21 12.84 21 11H6.44l-.95-2H2v2h2.22s1.89 4.07 2.12 4.42c-1.33.71-2.23 2.09-2.23 3.58 0 2.38 1.93 4.31 4.31 4.31s4.31-1.93 4.31-4.31c0-1.04-.39-1.98-1.03-2.72H18c1.08 0 2.09-.35 2.91-.96.33.26.71.48 1.09.66-.52.85-1.27 1.54-2.16 1.99-.25.12-.51.22-.78.3-.27.08-.55.14-.83.18-.28.04-.57.06-.86.06h-.11c-.29 0-.58-.02-.86-.06-.28-.04-.56-.1-.83-.18-.27-.08-.53-.18-.78-.3-.89-.45-1.64-1.14-2.16-1.99-.38-.18-.76-.4-1.09-.66.82.61 1.83.96 2.91.96h1.69c-.64.74-1.03 1.68-1.03 2.72 0 2.38 1.93 4.31 4.31 4.31s4.31-1.93 4.31-4.31c0-1.49-.9-2.87-2.23-3.58z"/>
              </svg>
            </div>
          </div>
          
          <div class="timeline-item">
            <div class="timeline-content">
              <div class="timeline-time">06:00 PM</div>
              <div class="timeline-event">Baile y fiesta</div>
            </div>
            <div class="timeline-icon">
              <svg viewBox="0 0 24 24">
                <path d="M20 6h-2.18c.11-.31.18-.65.18-1 0-1.66-1.34-3-3-3-1.05 0-1.96.54-2.5 1.35l-.5.67-.5-.68C10.96 2.54 10.05 2 9 2 7.34 2 6 3.34 6 5c0 .35.07.69.18 1H4c-1.11 0-1.99.89-1.99 2L2 19c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V8c0-1.11-.89-2-2-2zm-5-2c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM9 4c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm11 15H4v-2h16v2zm0-5H4V8h5.08L7 10.83 8.62 12 11 8.76l1-1.36 1 1.36L15.38 12 17 10.83 14.92 8H20v6z"/>
              </svg>
            </div>
          </div>
        </div>
      </div>

      <!-- Recomendación de Hospedaje -->
      <div class="hotel-container" aria-labelledby="hospedaje">
        <div id="hospedaje" class="hotel-title">Recomendación de Hospedaje</div>
        <div class="hotels-grid">
          <div class="hotel-card">
            <img class="hotel-image" src="https://images.unsplash.com/photo-1566073771259-6a8506099945?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=800&q=80" alt="Hotel Boutique Central" loading="lazy" />
            <div class="hotel-info">
              <div class="hotel-name">Hotel Boutique Central</div>
              <div class="hotel-address">
                Av. Revolución 145, Col. San Pedro de los Pinos,<br/>
                Álvaro Obregón, 01180 Ciudad de México, CDMX
              </div>
              <a class="hotel-button" href="https://www.google.com/maps/search/?api=1&query=Hotel+Boutique+Central,+Av.+Revolución+145,+Col.+San+Pedro+de+los+Pinos,+Álvaro+Obregón,+01180+Ciudad+de+México,+CDMX" target="_blank" rel="noopener noreferrer">Cómo llegar</a>
            </div>
          </div>
          
          <div class="hotel-card">
            <img class="hotel-image" src="https://images.unsplash.com/photo-1551882547-ff40c63fe5fa?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=800&q=80" alt="Suites del Parque" loading="lazy" />
            <div class="hotel-info">
              <div class="hotel-name">Suites del Parque</div>
              <div class="hotel-address">
                Calle Parque Lira 78, Col. Tacubaya,<br/>
                Miguel Hidalgo, 11870 Ciudad de México, CDMX
              </div>
              <a class="hotel-button" href="https://www.google.com/maps/search/?api=1&query=Suites+del+Parque,+Calle+Parque+Lira+78,+Col.+Tacubaya,+Miguel+Hidalgo,+11870+Ciudad+de+México,+CDMX" target="_blank" rel="noopener noreferrer">Cómo llegar</a>
            </div>
          </div>
        </div>
      </div>

      <button class="confirm-button" id="openRsvp" aria-haspopup="dialog">Confirma asistencia</button>
    </div>
  </div>

  <!-- Modal de galería -->
  <div id="galleryModal" class="gallery-modal">
    <div class="gallery-modal-content">
      <button class="gallery-modal-close" id="closeGalleryModal">&times;</button>
      <button class="gallery-modal-nav gallery-modal-prev" id="modalPrev">‹</button>
      <button class="gallery-modal-nav gallery-modal-next" id="modalNext">›</button>
      <img id="galleryModalImage" class="gallery-modal-image" src="" alt="">
      <div id="galleryModalCaption" class="gallery-modal-caption"></div>
    </div>
  </div>

  <!-- Modal de confirmación -->
  <div id="rsvpModal" class="modal" role="dialog" aria-modal="true" aria-hidden="true" aria-labelledby="modalTitle">
    <div class="modal-content" role="document">
      <button class="close-modal" id="closeModalBtn" aria-label="Cerrar">&times;</button>
      <div id="modalTitle" class="modal-title">Confirma tu asistencia</div>

      <form id="rsvpForm" novalidate>
        <div class="form-group">
          <label for="name" class="form-label">Nombre(s) y apellido(s):</label>
          <input id="name" name="name" type="text" autocomplete="name" required />
          <div class="error-message" id="nameError">Por favor ingresa tu nombre completo (mínimo 3 caracteres)</div>
        </div>

        <div class="form-group">
          <label for="email" class="form-label">Correo electrónico:</label>
          <input id="email" name="email" type="email" autocomplete="email" />
          <div class="error-message" id="emailError">Por favor ingresa un correo electrónico válido</div>
          <div class="warning-message" id="emailDuplicateError">Este correo electrónico ya ha confirmado asistencia</div>
        </div>

        <div class="form-group">
          <label for="phone" class="form-label">Número telefónico:</label>
          <input id="phone" name="phone" type="tel" autocomplete="tel" placeholder="(XX) XXXX-XXXX" />
          <div class="error-message" id="phoneError">Por favor ingresa un número telefónico válido (10 dígitos)</div>
        </div>

        <div class="form-group">
          <label for="adults" class="form-label">Número de adultos:</label>
          <input id="adults" name="adults" type="number" min="1" value="1" required />
          <div class="error-message" id="adultsError">Debe haber al menos 1 adulto</div>
        </div>

        <div class="form-group">
          <label for="children" class="form-label">Número de niños:</label>
          <input id="children" name="children" type="number" min="0" value="0" required />
          <div class="error-message" id="childrenError">El número de niños no puede ser negativo</div>
        </div>

        <button type="submit" class="submit-btn" id="submitBtn">Enviar confirmación</button>
        <div class="loading-spinner" id="loadingSpinner" aria-hidden="true"></div>
      </form>

      <div id="thankYouMessage" class="success" aria-live="polite">¡Gracias por confirmar!</div>
    </div>
  </div>

  <footer>
    Versión <strong>1.0.8</strong> — <time id="fechaPublicacion"></time>
  </footer>

  <!-- Scripts externos -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js" defer></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js" defer></script>

  <!-- Script principal -->
  <script>
    // =============================================
    // CONFIGURACIÓN Y DATOS
    // =============================================
    const firebaseConfig = {
      apiKey: "AIzaSyCTh8kPdvu-6Z5_cckNts22VrhdUTLVspM",
      authDomain: "invitea-f7331.firebaseapp.com",
      projectId: "invitea-f7331",
      storageBucket: "invitea-f7331.firebasestorage.app",
      messagingSenderId: "145115727672",
      appId: "1:145115727672:web:d1d89c20bf946b9e2663cd",
      measurementId: "G-8JS1MDZVGQ"
    };

    const galleryImages = [
      {
        url: "https://images.unsplash.com/photo-1583939003579-730e3918a45a?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=800&q=80",
        caption: "Nuestra primera cita"
      },
      {
        url: "https://images.unsplash.com/photo-1511895426328-dc8714191300?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=800&q=80",
        caption: "Viaje a la playa"
      },
      {
        url: "https://images.unsplash.com/photo-1511984804822-e16ba72f5848?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=800&q=80",
        caption: "Celebrando nuestro compromiso"
      },
      {
        url: "https://images.unsplash.com/photo-1519225421984-5157d7f14cac?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=800&q=80",
        caption: "Preparativos para la boda"
      },
      {
        url: "https://images.unsplash.com/photo-1571898224256-216d7db02223?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=800&q=80",
        caption: "Nuestro anillo de compromiso"
      },
      {
        url: "https://images.unsplash.com/photo-1511895426328-dc8714191300?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=800&q=80",
        caption: "Celebrando con amigos"
      },
      {
        url: "https://images.unsplash.com/photo-1511984804822-e16ba72f5848?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=800&q=80",
        caption: "Nuestro lugar favorito"
      }
    ];

    // =============================================
    // FUNCIONES UTILITARIAS
    // =============================================
    const utils = {
      // Pre-cargar imágenes
      preloadImage(url) {
        const img = new Image();
        img.src = url;
      },
      
      // Obtener fecha de mañana
      getTomorrowDate() {
        const tomorrow = new Date();
        tomorrow.setDate(tomorrow.getDate() + 1);
        tomorrow.setHours(10, 0, 0, 0); // 10:00 AM
        return tomorrow;
      },
      
      // Formatear fecha en español
      formatDateSpanish(date) {
        const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
        let formatted = date.toLocaleDateString('es-ES', options);
        return formatted.replace(/\b\w/g, l => l.toUpperCase());
      },
      
      // Validar email
      isValidEmail(email) {
        if (!email) return true;
        const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        return emailRegex.test(email);
      },
      
      // Validar teléfono
      isValidPhone(phone) {
        if (!phone) return true;
        const cleanPhone = phone.replace(/\D/g, '');
        return cleanPhone.length === 10;
      },
      
      // Formatear número de teléfono
      formatPhoneNumber(value) {
        const numbers = value.replace(/\D/g, '');
        if (numbers.length <= 2) return numbers;
        if (numbers.length <= 6) return `(${numbers.slice(0, 2)}) ${numbers.slice(2)}`;
        return `(${numbers.slice(0, 2)}) ${numbers.slice(2, 6)}-${numbers.slice(6, 10)}`;
      },
      
      // Verificar si el email ya existe en la base de datos
      async checkEmailExists(email) {
        if (!email || !this.isValidEmail(email)) return false;
        try {
          const snapshot = await window.db.collection('julianaypedro_boda')
            .where('email', '==', email.toLowerCase().trim()).get();
          return !snapshot.empty;
        } catch (error) {
          console.error('Error al verificar correo:', error);
          return false;
        }
      }
    };

    // =============================================
    // CUENTA REGRESIVA
    // =============================================
    const countdown = {
      start() {
        const weddingDate = utils.getTomorrowDate();
        
        const timer = setInterval(() => {
          const now = new Date().getTime();
          const distance = weddingDate - now;
          
          // Si ya pasó la fecha
          if (distance < 0) {
            clearInterval(timer);
            ['days','hours','minutes','seconds'].forEach(id => 
              document.getElementById(id).textContent = "00");
            document.getElementById("countdown-message").textContent = "¡El gran día ha llegado!";
            return;
          }
          
          // Calcular días, horas, minutos y segundos
          const days = Math.floor(distance / (1000 * 60 * 60 * 24));
          const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
          const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
          const seconds = Math.floor((distance % (1000 * 60)) / 1000);
          
          // Actualizar elementos del DOM
          document.getElementById("days").textContent = days.toString().padStart(2, '0');
          document.getElementById("hours").textContent = hours.toString().padStart(2, '0');
          document.getElementById("minutes").textContent = minutes.toString().padStart(2, '0');
          document.getElementById("seconds").textContent = seconds.toString().padStart(2, '0');
          
          // Actualizar mensaje según la proximidad del evento
          const messageElement = document.getElementById("countdown-message");
          if (days === 0 && hours < 24) {
            messageElement.textContent = "¡Hoy es el gran día!";
          } else if (days === 0) {
            messageElement.textContent = "¡Falta menos de un día!";
          } else if (days === 1) {
            messageElement.textContent = "¡Mañana es el gran día!";
          } else if (days < 7) {
            messageElement.textContent = "¡Ya casi es el gran día!";
          } else {
            messageElement.textContent = "¡Nos vemos pronto!";
          }
        }, 1000);
      }
    };

    // =============================================
    // GALERÍA COVER FLOW
    // =============================================
    const gallery = {
      init() {
        this.track = document.getElementById('coverflowTrack');
        this.prevBtn = document.getElementById('coverflowPrev');
        this.nextBtn = document.getElementById('coverflowNext');
        this.dotsContainer = document.getElementById('coverflowDots');
        this.counter = document.getElementById('coverflowCounter');
        
        this.currentIndex = 0;
        this.totalItems = galleryImages.length;
        this.itemWidth = 200;
        this.itemSpacing = 80;
        
        this.createGalleryItems();
        this.setupEventListeners();
        this.updateCoverflow();
      },
      
      // Crear elementos de la galería
      createGalleryItems() {
        galleryImages.forEach((image, index) => {
          // Crear elemento de imagen
          const item = document.createElement('div');
          item.className = 'coverflow-item';
          item.setAttribute('data-index', index);
          
          const img = document.createElement('img');
          img.src = image.url;
          img.alt = image.caption;
          img.className = 'coverflow-image';
          img.loading = 'lazy';
          
          const reflection = document.createElement('div');
          reflection.className = 'coverflow-reflection';
          
          item.appendChild(img);
          item.appendChild(reflection);
          this.track.appendChild(item);
          
          // Crear puntos de navegación
          const dot = document.createElement('div');
          dot.className = 'coverflow-dot';
          if (index === 0) dot.classList.add('active');
          dot.setAttribute('data-index', index);
          this.dotsContainer.appendChild(dot);
          
          // Pre-cargar imagen
          utils.preloadImage(image.url);
        });
      },
      
      // Configurar event listeners
      setupEventListeners() {
        this.prevBtn.addEventListener('click', () => this.prevSlide());
        this.nextBtn.addEventListener('click', () => this.nextSlide());
        
        this.dotsContainer.addEventListener('click', (e) => {
          if (e.target.classList.contains('coverflow-dot')) {
            const index = parseInt(e.target.getAttribute('data-index'));
            this.goToSlide(index);
          }
        });
        
        document.addEventListener('keydown', (e) => {
          if (e.key === 'ArrowLeft') this.prevSlide();
          if (e.key === 'ArrowRight') this.nextSlide();
        });
        
        // Soporte para dispositivos táctiles
        let startX = 0;
        this.track.addEventListener('touchstart', (e) => {
          startX = e.touches[0].clientX;
        });
        
        this.track.addEventListener('touchend', (e) => {
          const endX = e.changedTouches[0].clientX;
          const diff = startX - endX;
          if (Math.abs(diff) > 50) {
            diff > 0 ? this.nextSlide() : this.prevSlide();
          }
        });
      },
      
      // Actualizar la visualización del coverflow
      updateCoverflow() {
        const items = this.track.querySelectorAll('.coverflow-item');
        const dots = this.dotsContainer.querySelectorAll('.coverflow-dot');
        
        items.forEach((item, index) => {
          const position = index - this.currentIndex;
          const distance = Math.abs(position);
          
          let x = position * (this.itemWidth + this.itemSpacing);
          let scale = 1, zIndex = 1, opacity = 1, rotation = 0;
          
          // Aplicar transformaciones según la posición
          if (position === 0) {
            // Elemento central
            scale = 1.1;
            zIndex = 10;
            opacity = 1;
            rotation = 0;
            item.classList.add('active');
          } else if (distance === 1) {
            // Elementos adyacentes
            scale = 0.9;
            zIndex = 5;
            opacity = 0.8;
            rotation = position * 5;
          } else if (distance === 2) {
            // Elementos más lejanos
            scale = 0.7;
            zIndex = 3;
            opacity = 0.5;
            rotation = position * 10;
          } else {
            // Elementos más distantes
            scale = 0.5;
            zIndex = 1;
            opacity = 0.3;
            rotation = position * 15;
          }
          
          // Aplicar transformaciones
          item.style.transform = `translateX(${x}px) scale(${scale}) rotateY(${rotation}deg)`;
          item.style.zIndex = zIndex;
          item.style.opacity = opacity;
          
          if (position !== 0) item.classList.remove('active');
        });
        
        // Actualizar puntos de navegación
        dots.forEach((dot, index) => {
          dot.classList.toggle('active', index === this.currentIndex);
        });
        
        // Actualizar contador
        this.counter.textContent = `${this.currentIndex + 1} / ${this.totalItems}`;
        
        // Actualizar estado de botones
        this.prevBtn.disabled = this.currentIndex === 0;
        this.nextBtn.disabled = this.currentIndex === this.totalItems - 1;
      },
      
      // Ir a una diapositiva específica
      goToSlide(index) {
        this.currentIndex = index;
        this.updateCoverflow();
      },
      
      // Siguiente diapositiva
      nextSlide() {
        if (this.currentIndex < this.totalItems - 1) {
          this.currentIndex++;
          this.updateCoverflow();
        }
      },
      
      // Diapositiva anterior
      prevSlide() {
        if (this.currentIndex > 0) {
          this.currentIndex--;
          this.updateCoverflow();
        }
      }
    };

    // =============================================
    // MODAL DE GALERÍA
    // =============================================
    const modalGallery = {
      init(coverflow) {
        this.modal = document.getElementById('galleryModal');
        this.modalImage = document.getElementById('galleryModalImage');
        this.modalCaption = document.getElementById('galleryModalCaption');
        this.closeBtn = document.getElementById('closeGalleryModal');
        this.prevBtn = document.getElementById('modalPrev');
        this.nextBtn = document.getElementById('modalNext');
        
        this.coverflow = coverflow;
        this.setupEventListeners();
      },
      
      // Configurar event listeners
      setupEventListeners() {
        // Abrir modal al hacer clic en una imagen
        document.querySelectorAll('.coverflow-item').forEach(item => {
          item.addEventListener('click', () => {
            const index = parseInt(item.getAttribute('data-index'));
            this.coverflow.goToSlide(index);
            this.open(index);
          });
        });
        
        // Eventos de cierre y navegación
        this.closeBtn.addEventListener('click', () => this.close());
        this.prevBtn.addEventListener('click', () => this.prevImage());
        this.nextBtn.addEventListener('click', () => this.nextImage());
        
        // Cerrar al hacer clic fuera de la imagen
        this.modal.addEventListener('click', (e) => {
          if (e.target === this.modal) this.close();
        });
        
        // Navegación con teclado
        document.addEventListener('keydown', (e) => {
          if (this.modal.classList.contains('active')) {
            if (e.key === 'Escape') this.close();
            if (e.key === 'ArrowLeft') this.prevImage();
            if (e.key === 'ArrowRight') this.nextImage();
          }
        });
      },
      
      // Abrir modal
      open(index) {
        const imageData = galleryImages[index];
        this.modalImage.src = imageData.url;
        this.modalCaption.textContent = imageData.caption;
        this.modal.classList.add('active');
        document.body.style.overflow = 'hidden';
        this.currentIndex = index;
      },
      
      // Cerrar modal
      close() {
        this.modal.classList.remove('active');
        document.body.style.overflow = '';
      },
      
      // Siguiente imagen
      nextImage() {
        if (this.currentIndex < galleryImages.length - 1) {
          this.currentIndex++;
          this.open(this.currentIndex);
          this.coverflow.goToSlide(this.currentIndex);
        }
      },
      
      // Imagen anterior
      prevImage() {
        if (this.currentIndex > 0) {
          this.currentIndex--;
          this.open(this.currentIndex);
          this.coverflow.goToSlide(this.currentIndex);
        }
      }
    };

    // =============================================
    // MODAL DE CONFIRMACIÓN (RSVP)
    // =============================================
    const rsvpModal = {
      init() {
        this.openBtn = document.getElementById('openRsvp');
        this.modal = document.getElementById('rsvpModal');
        this.closeBtn = document.getElementById('closeModalBtn');
        this.form = document.getElementById('rsvpForm');
        this.submitBtn = document.getElementById('submitBtn');
        this.loadingSpinner = document.getElementById('loadingSpinner');
        this.thankYou = document.getElementById('thankYouMessage');
        
        // Elementos de formulario
        this.nameInput = document.getElementById('name');
        this.emailInput = document.getElementById('email');
        this.phoneInput = document.getElementById('phone');
        this.adultsInput = document.getElementById('adults');
        this.childrenInput = document.getElementById('children');
        
        // Elementos de error
        this.nameError = document.getElementById('nameError');
        this.emailError = document.getElementById('emailError');
        this.emailDuplicateError = document.getElementById('emailDuplicateError');
        this.phoneError = document.getElementById('phoneError');
        this.adultsError = document.getElementById('adultsError');
        this.childrenError = document.getElementById('childrenError');
        
        this.setupEventListeners();
      },
      
      // Configurar event listeners
      setupEventListeners() {
        this.openBtn.addEventListener('click', (e) => {
          e.preventDefault();
          this.open();
        });
        
        this.closeBtn.addEventListener('click', () => this.close());
        
        this.modal.addEventListener('click', (e) => {
          if (e.target === this.modal) this.close();
        });
        
        this.form.addEventListener('submit', (e) => this.handleSubmit(e));
        
        // Validación en tiempo real
        this.phoneInput.addEventListener('input', (e) => {
          e.target.value = utils.formatPhoneNumber(e.target.value);
          this.validatePhone(e.target.value);
        });
        
        this.emailInput.addEventListener('blur', () => this.validateEmail());
        this.nameInput.addEventListener('blur', () => this.validateName());
        this.adultsInput.addEventListener('blur', () => this.validateAdults());
        this.childrenInput.addEventListener('blur', () => this.validateChildren());
      },
      
      // Abrir modal
      open() {
        this.previousFocus = document.activeElement;
        this.modal.classList.add('active');
        this.modal.setAttribute('aria-hidden','false');
        document.body.style.overflow = 'hidden';
        
        // Enfocar en el primer campo después de un pequeño retraso
        setTimeout(() => {
          this.nameInput.focus();
        }, 50);
        
        document.addEventListener('keydown', this.handleKey.bind(this));
      },
      
      // Cerrar modal
      close() {
        this.modal.classList.remove('active');
        this.modal.setAttribute('aria-hidden','true');
        document.body.style.overflow = '';
        document.removeEventListener('keydown', this.handleKey.bind(this));
        
        // Restablecer formulario después de cerrar
        setTimeout(() => {
          this.thankYou.style.display = 'none';
          this.form.style.display = '';
          this.form.reset();
          this.adultsInput.value = 1;
          this.childrenInput.value = 0;
          
          // Limpiar errores
          [this.nameError, this.emailError, this.emailDuplicateError, this.phoneError, this.adultsError, this.childrenError]
            .forEach(error => error.style.display = 'none');
          
          [this.nameInput, this.emailInput, this.phoneInput, this.adultsInput, this.childrenInput]
            .forEach(input => input.classList.remove('error', 'warning'));
          
          // Restablecer botón de envío
          this.submitBtn.disabled = false;
          this.submitBtn.textContent = 'Enviar confirmación';
          this.loadingSpinner.style.display = 'none';
          
          // Restaurar foco
          this.previousFocus?.focus?.();
        }, 200);
      },
      
      // Manejar eventos de teclado
      handleKey(e) {
        // Cerrar con Escape
        if (e.key === 'Escape') this.close();
        
        // Manejar navegación por tabulación dentro del modal
        if (e.key === 'Tab' && this.modal.classList.contains('active')) {
          const focusableElements = this.modal.querySelectorAll('button, input, textarea, select, a[href]');
          const firstElement = focusableElements[0];
          const lastElement = focusableElements[focusableElements.length - 1];
          
          if (e.shiftKey && document.activeElement === firstElement) {
            lastElement.focus();
            e.preventDefault();
          } else if (!e.shiftKey && document.activeElement === lastElement) {
            firstElement.focus();
            e.preventDefault();
          }
        }
      },
      
      // Mostrar error
      showError(input, errorElement, message) {
        errorElement.textContent = message;
        errorElement.style.display = 'block';
        input.classList.add('error');
        input.focus();
      },
      
      // Limpiar error
      clearError(input, errorElement) {
        errorElement.style.display = 'none';
        input.classList.remove('error', 'warning');
      },
      
      // Validar nombre
      validateName() {
        if (this.nameInput.value.length < 3) {
          this.showError(this.nameInput, this.nameError, 'Por favor ingresa tu nombre completo (mínimo 3 caracteres)');
          return false;
        }
        this.clearError(this.nameInput, this.nameError);
        return true;
      },
      
      // Validar email
      async validateEmail() {
        const email = this.emailInput.value.trim();
        
        if (email && !utils.isValidEmail(email)) {
          this.showError(this.emailInput, this.emailError, 'Por favor ingresa un correo electrónico válido');
          this.emailDuplicateError.style.display = 'none';
          return false;
        }
        
        if (email && utils.isValidEmail(email)) {
          const emailExists = await utils.checkEmailExists(email);
          if (emailExists) {
            this.emailDuplicateError.style.display = 'block';
            this.emailError.style.display = 'none';
            this.emailInput.classList.add('warning');
            this.emailInput.classList.remove('error');
            return false;
          } else {
            this.clearError(this.emailInput, this.emailError);
            this.emailDuplicateError.style.display = 'none';
          }
        } else {
          this.clearError(this.emailInput, this.emailError);
          this.emailDuplicateError.style.display = 'none';
        }
        return true;
      },
      
      // Validar teléfono
      validatePhone(phone) {
        if (phone && !utils.isValidPhone(phone)) {
          this.showError(this.phoneInput, this.phoneError, 'Por favor ingresa un número telefónico válido (10 dígitos)');
          return false;
        }
        this.clearError(this.phoneInput, this.phoneError);
        return true;
      },
      
      // Validar número de adultos
      validateAdults() {
        if (this.adultsInput.value < 1) {
          this.showError(this.adultsInput, this.adultsError, 'Debe haber al menos 1 adulto');
          return false;
        }
        this.clearError(this.adultsInput, this.adultsError);
        return true;
      },
      
      // Validar número de niños
      validateChildren() {
        if (this.childrenInput.value < 0) {
          this.showError(this.childrenInput, this.childrenError, 'El número de niños no puede ser negativo');
          return false;
        }
        this.clearError(this.childrenInput, this.childrenError);
        return true;
      },
      
      // Manejar envío del formulario
      async handleSubmit(e) {
        e.preventDefault();
        
        // Verificar disponibilidad de base de datos
        if (!window.db) {
          alert('Base de datos no disponible. Por favor, intenta más tarde.');
          return;
        }
        
        // Ejecutar todas las validaciones
        const validations = [
          this.validateName(),
          await this.validateEmail(),
          this.validatePhone(this.phoneInput.value),
          this.validateAdults(),
          this.validateChildren()
        ];
        
        // Si hay errores, mostrar el primero
        if (!validations.every(v => v)) {
          const firstError = this.form.querySelector('.error, .warning');
          if (firstError) firstError.focus();
          return;
        }
        
        // Preparar envío
        this.submitBtn.disabled = true;
        this.submitBtn.textContent = 'Enviando...';
        this.loadingSpinner.style.display = 'block';

        // Recopilar datos del formulario
        const name = this.nameInput.value.trim();
        const email = this.emailInput.value.trim();
        const phone = this.phoneInput.value;
        const adults = Number(this.adultsInput.value) || 0;
        const children = Number(this.childrenInput.value) || 0;
        const userAgent = navigator.userAgent || '';
        const screenSize = `${window.innerWidth}x${window.innerHeight}`;

        try {
          // Guardar en Firebase
          await window.db.collection('julianaypedro_boda').add({
            nombre: name,
            email: email || 'No proporcionado',
            telefono: phone || 'No proporcionado',
            adultos: adults,
            ninos: children,
            dispositivo: userAgent,
            pantalla: screenSize,
            fecha: new Date().toLocaleString('es-MX'),
            timestamp: firebase.firestore.FieldValue.serverTimestamp(),
          });
          
          // Mostrar mensaje de éxito
          this.form.style.display = 'none';
          this.thankYou.style.display = 'block';
          this.loadingSpinner.style.display = 'none';
          
          // Cerrar automáticamente después de un tiempo
          setTimeout(() => this.close(), 1800);
        } catch(err) {
          console.error('Error al guardar en Firebase:', err);
          alert('Ocurrió un error al guardar. Por favor, intenta nuevamente.');
          
          // Restablecer botón de envío
          this.submitBtn.disabled = false;
          this.submitBtn.textContent = 'Enviar confirmación';
          this.loadingSpinner.style.display = 'none';
        }
      }
    };

    // =============================================
    // INICIALIZACIÓN
    // =============================================
    window.addEventListener('load', () => {
      // Pre-cargar imagen principal
      utils.preloadImage('https://images.unsplash.com/photo-1519225421984-5157d7f14cac?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=800&q=80');
      
      // Configurar fecha del evento (mañana)
      const weddingDate = utils.getTomorrowDate();
      document.getElementById('dynamicDate').textContent = utils.formatDateSpanish(weddingDate);
      
      // Inicializar componentes
      countdown.start();
      gallery.init();
      modalGallery.init(gallery);
      rsvpModal.init();
      
      // Inicializar Firebase
      if (window.firebase && firebase.initializeApp) {
        try {
          firebase.initializeApp(firebaseConfig);
          window.db = firebase.firestore();
        } catch(e) {
          console.warn('Firebase init:', e);
        }
      } else {
        console.warn('Firebase no cargó correctamente.');
      }

      // Configurar fecha de publicación
      document.getElementById('fechaPublicacion').textContent =
        new Date().toLocaleString('es-MX', {
          year: 'numeric',
          month: 'short',
          day: '2-digit',
          hour: '2-digit',
          minute: '2-digit'
        });
    });
  </script>
</body>
</html>
